// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER  
  ADMIN 
}

enum Species {
  DOG
  CAT
  BIRD
  OTHER
}

enum RecordType {
  VACCINE
  DEWORMING    
  CONSULTATION
  EXAM         
  SURGERY      
  OTHER
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String   
  role      Role     @default(USER) 

  ownedPets   Pet[]  @relation("OwnerRelation") 
  tutoredPets Pet[]  @relation("TutorRelation") 

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Pet {
  id        Int       @id @default(autoincrement())
  name      String
  species   Species 
  breed     String?  
  birthDate DateTime? 
  weight    Float?    
  pedigree  Boolean   @default(false) 
  healthRecords HealthRecord[]
  ownerId   Int
  owner     User      @relation("OwnerRelation", fields: [ownerId], references: [id], onDelete: Cascade)

  tutors    User[]    @relation("TutorRelation")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("pets")
}

model HealthRecord {
  id          Int        @id @default(autoincrement())
  
  type        RecordType 
  title       String     
  
  date        DateTime   
  nextDueDate DateTime?   
  
  notes       String?    
  doctor      String?    
  clinic      String?    

  petId       Int
  pet         Pet        @relation(fields: [petId], references: [id], onDelete: Cascade)

  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  @@map("health_records")
}